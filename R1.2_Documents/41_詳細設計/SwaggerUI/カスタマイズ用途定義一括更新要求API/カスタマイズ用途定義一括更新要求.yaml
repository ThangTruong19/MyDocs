swagger: '2.0'
info:
  title: 次世代KOMTRAX API
  description: |
    # 変更履歴
    <table>
      <tr><th>日付</th><th>変更内容</th></tr>
      <tr>
        <td>2022/3/30</td>
        <td>作成</td>
      </tr>
    </table>
  version: ''
paths:
  #パス名（パスパラメータを用いる場合{xxx_id}を入れる）
  /cars/requests/customize_usage_definitions/s2m/upload:
  #path_start
    #get|put|post|delete
    post: 
      # API名
      summary: カスタマイズ用途定義一括更新要求API [API_ID：KOM-00110100]
      # API説明文
      description: |
        ファイルをアップロードにより一括でカスタマイズ用途定義の更新を車両に要求する。
        <h1>エラーコード一覧</h1>
        <!-- ない、もしくは未定の場合は見出し、表を削除 -->
        
        <ul>
          <li>API共通で返却されるエラーメッセージは<a href="https://miot-msd.jp.fujitsu.com/komtrax/resources/api/komtrax_docs/messages.html" target="_blank">KOMTRAX共通メッセージ</a>を参照</li>
          <style type="text/css">
            .kom_error_messages{
                background-color: #0001;
                height: auto;
                padding: 0;
              }
              .kom_error_messages table {
                width:100%;
                table-layout: fixed;
                word-wrap: break-word;
              }
              .kom_error_messages .kom_status {width: 7%}
              .kom_error_messages .kom_name {width: 20%}
              .kom_error_messages .kom_code {width: 10%}
              .kom_error_messages .kom_message {width: 30%}
              .kom_error_messages .kom_cause {width: 23%}
              .kom_error_messages .kom_remarks {width: 10%}
              .kom_error_bg{
                padding: 5px;
                border-radius: 2px;
              }
          </style>
          <li class="kom_error_bg"> エラー一覧
            <details>
              <div class="kom_error_messages">
                <table border=1>
                  <tr>
                    <th class="kom_status">HTTP<br>ステータス</th>
                    <th class="kom_name">項目名</th>
                    <th class="kom_code">エラーコード</th>
                    <th class="kom_message">出力メッセージ</th>
                    <th class="kom_cause">要因</th>
                    <th class="kom_remarks">備考</th>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>file_label</td>
                    <td>ACOM0441E</td>
                    <td>{{file_label }}は128文字以内で入力してください。(ハイフンマイナス、半角アンダーバー、半角ピリオド以外の記号は使用できません。また、最後の文字に記号は使用できません。)</td>
                    <td>指定されたファイル名が128桁を超えるか、ハイフンマイナス、半角アンダーバー、半角ピリオド以外の記号が使用されているか、末尾に記号が使用されているかのどれかに該当する場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>file_upload_condition.file_request_label</td>
                    <td>ACOM0112E</td>
                    <td>{{file_upload_condition.file_request_label}}は1～255桁で入力してください。</td>
                    <td>項目で指定された桁数の範囲外である場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>file_upload_condition.processing_type</td>
                    <td>ACOM0442E</td>
                    <td>{{file_upload_condition.processing_type}}に指定された値は利用できません。</td>
                    <td>処理区分に指定できない値が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>file_upload_condition.processing_type</td>
                    <td>ACOM0108E</td>
                    <td>{{file_upload_condition.processing_type}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>404</td>
                    <td>car_id</td>
                    <td>ACOM0248E</td>
                    <td>指定された車両は存在しません。</td>
                    <td>指定された車両IDの車両が存在しない、または参照する権限が無い場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>car_id</td>
                    <td>ACOM0108E</td>
                    <td>{{car_id}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>car_id</td>
                    <td>ACAR0173E</td>
                    <td>{{car_id}}は1～19桁の半角数字で入力してください。</td>
                    <td>ID項目に1～19桁の半角数字以外が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>request_route_kind</td>
                    <td>ACOM0108E</td>
                    <td>{{request_route_kind}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>request_route_kind</td>
                    <td>ACOM0163E</td>
                    <td>{{request_route_kind}}に指定された値は利用できません。</td>
                    <td>要求経路区分に指定できない値が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>instant_kind</td>
                    <td>ACOM0163E</td>
                    <td>{{instant_kind}}に指定された値は利用できません。</td>
                    <td>即時反映に指定できない値が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>continuous_kind</td>
                    <td>ACOM0163E</td>
                    <td>{{continuous_kind}}に指定された値は利用できません。</td>
                    <td>継続有無に指定できない値が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>instant_kind<br/>continuous_kind</td>
                    <td>ACOM0163E</td>
                    <td>{{instant_kind}}に即時が指定された場合、{{continuous_kind}}の入力は必須です。</td>
                    <td>即時反映に即時を指定かつ継続有無が未指定の場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.customize_usage_definition_id</td>
                    <td>ACOM0418E</td>
                    <td>{{customize_usage_definition.customize_usage_definition_id}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.customize_usage_definition_id</td>
                    <td>ACAR0173E</td>
                    <td>{{customize_usage_definition.customize_usage_definition_id}}は1～19桁の半角数字で入力してください。</td>
                    <td>ID項目に1～19桁の半角数字以外が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.version</td>
                    <td>ACOM0418E</td>
                    <td>{{customize_usage_definition.version}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>            
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.request_kind</td>
                    <td>ACOM0418E</td>
                    <td>{{customize_usage_definition.request_kind}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.request_kind</td>
                    <td>ACOM0163E</td>
                    <td>{{customize_usage_definition.request_kind}}に指定された値は利用できません。</td>
                    <td>実施内容に指定できない値が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.priority</td>
                    <td>ACOM0163E</td>
                    <td>{{customize_usage_definition.priority}}に指定された値は利用できません。</td>
                    <td>優先度に指定できない値が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.date_to</td>
                    <td>ACOM0418E</td>
                    <td>{{customize_usage_definition.date_to}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.date_to</td>
                    <td>ACAR0152E</td>
                    <td>日付は'YYYY-MM-DD'の形式で入力してください。</td>
                    <td>指定された日付の形式が不正な場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.date_from</td>
                    <td>ACOM0418E</td>
                    <td>{{customize_usage_definition.date_from}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.date_from</td>
                    <td>ACAR0152E</td>
                    <td>日付は'YYYY-MM-DD'の形式で入力してください。</td>
                    <td>指定された日付の形式が不正な場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.active_kind</td>
                    <td>ACOM0418E</td>
                    <td>{{customize_usage_definition.active_kind}}の入力は必須です。</td>
                    <td>入力必須項目が存在しない、または、存在しても値が指定されていない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.active_kind</td>
                    <td>ACOM0163E</td>
                    <td>{{customize_usage_definition.active_kind}}に指定された値は利用できません。</td>
                    <td>有効・無効に指定できない値が入力された場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>customize_usage_definition.date_to</br>
                    customize_usage_definition.date_from
                    </td>
                    <td>ACOM0169E</td>
                    <td>{{customize_usage_definition.date_to}}は{{customize_usage_definition.date_from}}以降の日付で入力してください。</td>
                    <td>期間指定の終了日付が開始日付以降ではない場合に返却されます。</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>400</td>
                    <td>instant_kind</br>
                    customize_usage_definition.request_kind
                    </td>
                    <td></td>
                    <td>{{instant_kind}}に即時が指定された場合、{{customize_usage_definition.request_kind}}に削除は指定できません。</td>
                    <td>即時反映に即時を指定かつ実施内容に削除が指定された場合に返却されます。</td>
                    <td></td>
                  </tr>
                </table>
              </div>
            </details>
          </li>
        </ul>
        
        <h1>特記事項</h1>
        Content-Type: multipart/form-data でファイルとjsonの送信を行う。<br>
        <hr>
        <h1>ファイル形式</h1>
        API入出力ファイルの仕様は<a href="https://miot-msd.jp.fujitsu.com/komtrax/resources/api/spec/komtrax_paths/manufactures/format/F004002_manufactures-cars-template_create.pdf" target="_blank">API入出力ファイル仕様書</a>に示す。<br>
        アップロード可能なファイル形式を下記に示す。<br>
        <table>
          <tr><th align="left">ファイル形式</th><th align="left">File-Content-Type</th></tr>
          <tr><td><a href="https://miot-msd.jp.fujitsu.com/komtrax/resources/api/spec/komtrax_paths/manufactures/format/manufactures-cars-template_create.xlsx">excel</a></td><td>application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</td></tr>
        </table>
        <br>
        登録要求用アップロードファイルは<a href=""_blank">車両カスタマイズ用途定義一括登録テンプレートファイル作成API</a>より取得する。<br>
        更新・削除要求用アップロードファイルは<a href=""_blank">車両カスタマイズ用途定義一括更新テンプレートファイル作成API</a>より取得する。<br>
        <br>
        アップロード結果はレスポンスボディとして返却し、結果ファイルも出力する。
        <br>
        出力した結果ファイルは<a href="https://miot-msd.jp.fujitsu.com/komtrax/resources/api/?url=./spec/komtrax_paths/applications/applications-files-{file_id}.json" target="_blank">ファイル取得API</a>によってダウンロード可能とする。<br>
        アップロード結果ファイルの仕様は<a href="" target="_blank">API入出力ファイル仕様書</a>に示す。<br>
        ダウンロード可能なファイルを下記に示す。
        <table>
          <tr><th align="left">ファイル</th><th align="left">File-Content-Type</th></tr>
          <tr>
            <td><a href="">アップロード結果ファイル</a></td>
            <td>
              application/vnd.openxmlformats-officedocument.spreadsheetml.sheet<br>
            </td>
          </tr>
        </table>
        <hr>
        <h1>同期/非同期実行</h1>
        同期/非同期実行の 可/不可 を下記に示す。<br>
        <table>
          <tr><th align="left">実行</th><th align="left">可/不可</th></tr>
          <tr><td>同期</td><td>○</td></tr>
          <tr><td>非同期</td><td>－</td></tr>
        </table>
        <hr>

      # リクエスト
      consumes:
        - multipart/form-data
      parameters:
        #共通のヘッダ
        - name: X-Lang
          in: header
          description: |
            論理名　　　：言語タグ<br>
            使用可能文字：半角英数字,ハイフンマイナス<br>
            桁／文字数　：2～35<br>
            備考　　　　：詳細はAPI設計ポリシーを参照
          required: false
          type: string
        - name: X-AppCode
          in: header
          description: |
            論理名　　　：アプリコード<br>
            使用可能文字：半角英数記号<br>
            桁／文字数　：36<br>
            備考　　　　：詳細はAPI設計ポリシーを参照
          required: false
          type: string
        - name: X-GroupId
          in: header
          description: |
            論理名　　　：グループID<br>
            使用可能文字：半角数字<br>
            桁／文字数　：1～19<br>
            備考　　　　：詳細はAPI設計ポリシーを参照
          required: false
          type: string
        - name: X-DateFormat
          in: header
          description: |
            論理名　　　：日付形式<br>
            使用可能文字：半角数字<br>
            桁／文字数　：1<br>
            備考　　　　：詳細はAPI設計ポリシーを参照
          required: false
          type: string
        - name: X-ScreenCode
          in: header
          description: |
            論理名　　　：画面コード<br>
            使用可能文字：半角英数字,半角アンダーバー<br>
            桁／文字数　：1～64<br>
            備考　　　　：詳細はAPI設計ポリシーを参照
          required: false
          type: string
        - name: X-WebApiKey
          in: header
          description: |
            論理名　　　：WebAPIキー<br>
            使用可能文字：半角英数記号<br>
            桁／文字数　：1～36<br>
            備考　　　　：詳細はAPI設計ポリシーを参照
          required: false
          type: string
          
        - name: json
          in: formData
          description: |
            JSON文字列                                                         <br>
            Content-Type: application/json

                description:  カスタマイズ用途定義一括更新要求リクエスト
    
                file_label: string 
                    description: ファイル名 デフォルトのファイル名は「cars-requests-customize_usage_definitions-s2m-upload＋年月日時分秒（グループのローカル）＋拡張子」（X-Langに従う）となる。
                    minLength: 1
                    maxLength: 128
                    pattern: ALL（ハイフンマイナス、半角アンダーバー、半角ピリオド以外の記号を除く）、記号で終わらないこと
                    example: cars-requests-customize_usage_definitions-s2m-upload20170523235959.xlsx
    
                file_upload_condition:
                    description:  ファイルアップロード条件
                    
                    processing_type:  string *
                        処理区分 0：同期のみとする。アップロード処理結果を返却する。 
                        minLength: 1
                        maxLength: 1
                        pattern: 半角数字
                        example: 0
                        Enum: [ 0:同期 ]
                    file_request_label: string 
                        ファイル要求名 省略時はリクエスト時のX-Lang指定に従ったデフォルト名を補填する 
                        minLength: 1
                        maxLength: 255
                        pattern: ALL
                        example: カスタマイズ用途定義一括更新要求
          required: true
          type: string
        - name: file
          in: formData
          description: |
            アップロードファイル<br>
            File-Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
          required: true
          type: file
          
      # タグはnamespaceとする
      tags:
        - cars
      # レスポンス
      responses:
        '200':
          #レスポンスについて簡単な説明（例：どんな情報を返すか）
          description: | 
           リクエストキーを返却する。
          schema:
            type: object
            properties:
              result_data:
                type: object
                properties:
                  request_keys:
                    type: array
                    items:
                      type: string
                      description: リクエストキー（36進数文字列）
                      pattern: 半角英数字
                      maxLength: 10
                      minLength: 1
                      example: ffa112ba1d
        #common_error
  #path_end
