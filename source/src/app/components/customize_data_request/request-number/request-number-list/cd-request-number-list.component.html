<section id="app-cd-request-number-list" *ngIf="labels && resource">
    <div class="app-content">
        <ng-container>
            <!-- 検索アコーディオン -->
            <app-accordion [collapsed]="collapsed" [useCustomHeader]="false" [title]="labels.search_condition"
                [labels]="labels" (onChangeState)="changePanelState($event)">
                <div data-app-accordion-body>
                    <div class="container app-search">
                        <div class="row">
                            <app-selected class="col-sm-3" *ngIf="resource.request_number_definition_ids"
                                [itemName]="'request_number_definition_ids'" [itemParams]="params"
                                [itemResource]="resource" [emitInitialRefresh]="false">
                            </app-selected>

                            <app-from-to-date-time-picker #fromToDatePicker style="width: 600px;"
                                [from]="'request_number_datetime_from'" [to]="'request_number_datetime_to'"
                                [params]="params" [resource]="resource" [labels]="labels"
                                [beginningWday]="beginningWday" [enableDateRange]="enableDateRange"
                                [dateFormat]="dateFormat" [timeZone]="timeZone" [showSeconds]="true"
                                [showMilliseconds]="false" [fromShowLabel]="true" [toShowLabel]="true"
                                [required]="true">
                            </app-from-to-date-time-picker>

                            <app-selected style="margin-left: -70px;" class="col-sm-2"
                                *ngIf="resource.request_number_status" [itemName]="'request_number_status'"
                                [itemParams]="params" [itemResource]="resource" [emitInitialRefresh]="false">
                            </app-selected>
                        </div>
                    </div>
                    <div class="app-panel-footer">
                        <button (click)="onClickSearch()" type="button" class="btn btn-primary search">
                            {{ labels.search }}
                        </button>
                    </div>
                </div>
            </app-accordion>

            <!-- 一覧テーブル上部検索オプション欄 -->
            <div class="app-table-options" [hidden]="count <= 0">
                <app-pagination [count]="count" [params]="pageParams" [labels]="labels" [element]="pageCountEl"
                    (changeState)="onPaginationChange()">
                </app-pagination>

                <div class="table-option-buttons">
                    <div class="popover-wrapper">
                        <button type="button" class="btn btn-warning">
                            {{ labels.setting_request_modal }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- 一覧テーブル -->
            <div class="app-table-wrapper">
                <app-common-table
                    [customTableThContent]="customTableThContent"
                    [customTableRowContent]="customTableRowContent"
                    [lists]="lists"
                    [thList]="thList"
                    [labels]="labels"
                    [pageParams]="pageParams"
                    [collapsed]="collapsed"
                    [isFetching]="isFetching"
                    [selectable]="selectable"
                    [checkIdName]="checkIdName"
                    [checkedItems]="checkedItems"
                    [(sortingParams)]="sortingParams"
                    [emptyListMessage]="'Empty'"
                >
                </app-common-table>
            </div>
        </ng-container>
    </div>
</section>

<ng-template #customTableThContent>
    <ng-container *ngFor="let th of thList; let thIdx = index">
      <ng-container *ngIf="th.displayable">
        <th
          style="width: 25%;"
          class="app-index-th th-{{ th.shortName }}"
          appSortingLabel
          [ngClass]="{ 'disable-sort': !th.sortable }"
          [(sortingParams)]="sortingParams"
          [labelName]="th.sortKey || th.name"
          [sortableThList]="sortableThList"
          (sort)="onChangeSort($event)"
        >
          <span>{{ th.label || labels[th.shortName] }}</span>
        </th>
      </ng-container>

      <ng-template #checkboxContent>
        <th class="app-index-th fixed th-check">
          <input
              type="checkbox"
              class="app-input-checkbox"
              id="check-icon-all"
              (click)="toggleCheckAll()"
              [checked]="checkAll"
          />
          <label class="app-input-checkbox__label" for="check-icon-all">
              <i class="fa"></i>
          </label>
        </th>
      </ng-template>
    </ng-container>
  </ng-template>

  <ng-template #customTableRowContent
    let-data="data"
    let-title="title"
    let-tblFunctions="tblFunctions">
    <ng-container *ngFor="let title of thList; let thIdx = index">
      <ng-container [ngSwitch]="title.name" *ngIf="title.displayable && !isArrayColumnData(title.name)">
        <td style="width: 25%;" class="td-{{ title.shortName }} app-index-td d-flex align-items-center padding-none">
          <span class="divider-column">{{ data[title.name] }}</span>
        </td>
      </ng-container>
      <ng-container *ngIf="title.displayable && isArrayColumnData(title.name)">
        <td style="width: 25%;" class="td-{{ title.shortName }} app-index-td align-items-center padding-none">
        <ng-container *ngFor="let rec of tblFunctions.getArrayColumnData(data, title.name); let subIndex = index">
            <div [ngClass]="{'divider-column-border': subIndex > 0}" class="divider-column">
                <span>{{rec[tblFunctions.getLastColumnPathName(title.name)]}}</span>
            </div>
        </ng-container>
        </td>
    </ng-container>

    </ng-container>
  </ng-template>