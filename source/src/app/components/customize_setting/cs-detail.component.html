<section id="app-cs-detail" *ngIf="labels && resource">
    <div class="container-fluid">
        <h2 class="app-page-title">{{ labels.title }}</h2>
        <div class="app-content">
            <!-- 一覧画面 -->
            <ng-container>
                <div class="container">
                    <label
                        >{{ labels.maker_model_type_rev_serial }} {{ model }}-
                        {{ typeRev }}-{{ serial }}
                    </label>
                    <!-- TODO: -->
                    <div class="app-control">
                        <button
                            type="button"
                            class="btn"
                            title="追加"
                            (click)="onClickAdd()"
                        >
                            <span>
                                <i class="app-icon app-icon-add"> </i>
                            </span>
                        </button>
                        <button
                            type="button"
                            class="btn"
                            title="編集内容破棄"
                            [disabled]="disabled"
                            (click)="onClickDiscardAll()"
                        >
                            <span>
                                <i class="app-icon app-icon-discard"> </i>
                            </span>
                        </button>
                        <button
                            type="button"
                            class="btn"
                            title="設定取得要求"
                            (click)="onClickGetRequest()"
                        >
                            <span>
                                <i
                                    class="app-icon app-icon-acquisition-request"
                                >
                                </i>
                            </span>
                        </button>
                        <button
                            type="button"
                            class="btn"
                            title="設定更新要求"
                            [disabled]="disabled"
                            (click)="onClickUpdateRequest()"
                        >
                            <span>
                                <i class="app-icon app-icon-update-request">
                                </i>
                            </span>
                        </button>
                        <button
                            type="button"
                            class="btn"
                            title="設定即時更新要求"
                            [disabled]="disabled"
                            (click)="onClickImmediateUpdateRequest()"
                        >
                            <span>
                                <i class="app-icon app-icon-update-request">
                                </i>
                            </span>
                        </button>
                    </div>
                    <!-- 一覧テーブル上部検索オプション欄 -->
                    <div class="app-table-options" [hidden]="count <= 0">
                        <app-pagination
                            [count]="count"
                            [params]="pageParams"
                            [labels]="labels"
                            [element]="pageCountEl"
                            (changeState)="onPaginationChange()"
                        >
                        </app-pagination>
                    </div>

                    <!-- 一覧テーブル -->
                    <div class="app-table-wrapper">
                        <app-common-table
                            [checkBoxHiddenFunction]="checkBoxHiddenFunction"
                            [checkBoxDefaultHiddenFunction]="
                                checkBoxDefaultHiddenFunction
                            "
                            [customFixedTableThContent]="
                                customFixedTableThContent
                            "
                            [customFixedTableRowContent]="
                                customFixedTableRowContent
                            "
                            [customTableThContent]="customTableThContent"
                            [customTableRowContent]="customTableRowContent"
                            [labels]="labels"
                            [collapsed]="collapsed"
                            [lists]="lists"
                            [pageParams]="pageParams"
                            [fixedThList]="fixedThList"
                            [scrollableThList]="scrollableThList"
                            [(sortingParams)]="sortingParams"
                            [sortableThList]="sortableThList"
                            [selectable]="selectable"
                            [isFetching]="isFetching"
                            [checkIdName]="checkIdName"
                            [checkedItems]="checkedItems"
                            [checkAll]="checkAll"

                            (sort)="onChangeSort($event)"
                        >
                        <!-- TODO: -->
                        <!-- [mergeColumns]="mergeColumns" -->
                            <ng-template #customFixedTableThContent>
                                <th class="fixed">{{ labels.edit_label }}</th>
                                <th class="fixed">
                                    {{ labels.edit_status_label }}
                                </th>
                                <ng-container *ngFor="let title of fixedThList">
                                    <th
                                        *ngIf="title.displayable"
                                        class="th-{{
                                            title.shortName
                                        }} app-index-th"
                                        [ngClass]="{
                                            'disable-sort': !title.sortable
                                        }"
                                        appSortingLabel
                                        [(sortingParams)]="sortingParams"
                                        [labelName]="title.name"
                                        [sortableThList]="sortableThList"
                                        (sort)="onChangeSort($event)"
                                    >
                                        {{ title.label }}
                                    </th>
                                </ng-container>
                            </ng-template>
                            <ng-template
                                #customFixedTableRowContent
                                let-data="data"
                                let-tblFunctions="tblFunctions"
                            >
                                <!-- TODO: 判定条件、メソッド等 -->
                                <td
                                    *ngIf="
                                        tblFunctions.isDisplayFixedDataRow(
                                            data
                                        )
                                    "
                                    class="app-index-td app-table__small app-sm-link text-center fixed"
                                    [attr.rowspan]="tblFunctions.getFixedDataRowspan(data)"
                                    (click)="onClickEdit(data)"
                                >
                                    <span>
                                        <i class="app-icon app-icon-edit"> </i>
                                    </span>
                                </td>
                                <td
                                    *ngIf="
                                        tblFunctions.isDisplayFixedDataRow(
                                            data
                                        )
                                    "
                                    class="app-index-td app-table__small text-center fixed"
                                    [attr.rowspan]="
                                        tblFunctions.getFixedDataRowspan(
                                            data
                                        )
                                    "
                                >
                                    <span>
                                        {{ data["edit_status_name"] }}
                                    </span>
                                </td>
                                <ng-container *ngFor="let title of fixedThList">
                                    <td
                                        *ngIf="
                                            tblFunctions.isDisplayDataRow(
                                                title,
                                                data
                                            )
                                        "
                                        class="td-{{
                                            title.shortName
                                        }} app-index-td"
                                        [style]="tblFunctions.getColumnStyle(title)"
                                        [attr.rowspan]="
                                            tblFunctions.getDataRowspan(
                                                title,
                                                data
                                            )
                                        "
                                    >
                                        <span>{{
                                            data[title.dataKey || title.name]
                                        }}</span>
                                    </td>
                                </ng-container>
                            </ng-template>
                            <ng-template #customTableThContent>
                                <ng-container
                                    *ngFor="let title of scrollableThList"
                                >
                                    <th
                                        *ngIf="title.displayable"
                                        class="th-{{
                                            title.shortName
                                        }} app-index-th"
                                        [ngClass]="{
                                            'disable-sort': !title.sortable
                                        }"
                                        appSortingLabel
                                        [(sortingParams)]="sortingParams"
                                        [labelName]="title.name"
                                        [sortableThList]="sortableThList"
                                        (sort)="onChangeSort($event)"
                                    >
                                        {{ title.label }}
                                    </th>
                                </ng-container>
                                <th class="fixed">
                                    {{ labels.discard_label }}
                                </th>
                                <th class="fixed">
                                    {{ labels.retry_label }}
                                </th>
                            </ng-template>
                            <ng-template #customTableRowContent
                                let-data="data"
                                let-tblFunctions="tblFunctions"
                            >
                                <ng-container
                                    *ngFor="let title of scrollableThList"
                                >
                                    <td
                                        *ngIf="
                                            tblFunctions.isDisplayDataRow(
                                                title,
                                                data
                                            )
                                        "
                                        class="td-{{
                                            title.shortName
                                        }} app-index-td"
                                        [style]="tblFunctions.getColumnStyle(title)"
                                        [attr.rowspan]="
                                            tblFunctions.getDataRowspan(
                                                title,
                                                data
                                            )
                                        "
                                    >
                                        <span>{{
                                            data[title.dataKey || title.name]
                                        }}</span>
                                    </td>
                                </ng-container>
                                <!-- TODO: 判定条件、メソッド等 -->
                                <td
                                    *ngIf="
                                        tblFunctions.isDisplayFixedDataRow(
                                            data
                                        )
                                    "
                                    class="app-index-td app-table__small app-sm-link text-center fixed"
                                    [ngClass]="{
                                        disable: discardIconHiddenFunction(data)
                                    }"
                                    (click)="onClickDiscard(data)"
                                    [attr.rowspan]="
                                        tblFunctions.getFixedDataRowspan(
                                            data
                                        )
                                    "
                                >
                                    <span>
                                        <i
                                            *ngIf="
                                                !discardIconHiddenFunction(data)
                                            "
                                            class="app-icon app-icon-discard"
                                        >
                                        </i>
                                    </span>
                                </td>
                                <td
                                    *ngIf="
                                        tblFunctions.isDisplayFixedDataRow(
                                            data
                                        )
                                    "
                                    class="app-index-td app-table__small app-sm-link text-center fixed"
                                    [ngClass]="{
                                        disable: retryIconHiddenFunction(data)
                                    }"
                                    (click)="onClickRetry(data)"
                                    [attr.rowspan]="
                                        tblFunctions.getFixedDataRowspan(
                                            data
                                        )
                                    "
                                >
                                    <span>
                                        <i
                                            *ngIf="
                                                !retryIconHiddenFunction(data)
                                            "
                                            class="app-icon app-icon-discard"
                                        >
                                        </i>
                                    </span>
                                </td>
                            </ng-template>
                        </app-common-table>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
    <ng-template #csNewModalContent>
        <app-cs-new [carId]="carId" [resources]="resources" [initThLst]="this.thList"></app-cs-new>
    </ng-template>
    <ng-template #csEditModalContent>
        <app-cs-edit
            [carId]="carId"
            [inputParams]="inputParams"
            [resources]="resources"
            [initThLst]="this.thList"
        ></app-cs-edit>
    </ng-template>
    <ng-template #csGetRequestModalContent>
        <app-cs-get-request [labels]="labels"></app-cs-get-request>
    </ng-template>
    <ng-template #csUpdateRequestConfirmModalContent>
        <app-cs-update-request-confirm
            [labels]="labels"
            [tableData]="tableData"
            [initThLst]="this.thList"
        >
        </app-cs-update-request-confirm>
    </ng-template>
    <ng-template #csImmediateUpdateRequestConfirmModalContent>
        <app-cs-immediate-update-request-confirm
            [labels]="labels"
            [tableData]="tableData"
            [initThLst]="this.thList"
        >
        </app-cs-immediate-update-request-confirm>
    </ng-template>
    <ng-template #csInputDataCancelConfirmModalContent>
        <app-cs-input-data-cancel-confirm [labels]="labels">
        </app-cs-input-data-cancel-confirm>
    </ng-template>
    <ng-template #csRequestResendConfirmModalContent>
        <app-cs-request-resend-confirm
            [labels]="labels"
            [tableData]="tableData"
            [initThLst]="this.thList"
        >
        </app-cs-request-resend-confirm>
    </ng-template>
</section>
<app-sidemenu [isLoading]="isLoading"></app-sidemenu>
